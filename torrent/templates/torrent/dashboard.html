{% extends "torrent/base.html" %}
{% block title %}Bitiso.org | Dashboard{% endblock %}
{% block content %}
<div class="container">
        <h2>Welcome to your Dashboard</h2>
        <p>Hello, {{ user.username }}!</p>
        <p>You have {{ torrent_count }} torrents.</p>

        {% if messages %}
            <div class="alert alert-dismissible">
                {% for message in messages %}
                    <div class="alert alert-{{ message.tags }}">
                        {{ message }}
                    </div>
                {% endfor %}
            </div>
        {% endif %}

        <h3>Your Torrents:</h3>
        <form method="post" action="{% url 'delete_torrents' %}">
            {% csrf_token %}
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th></th>
                        <th>Name</th>
                        <th>Size</th>
                        <th>Pieces</th>
                        <th>Piece Size</th>
                        <th>Seeds</th>
                        <th>Leeches</th>
                        <th>Downloads</th>
                        <th>Completed</th>
                        <th>Added At</th>
                    </tr>
                </thead>
                <tbody>
                    {% for torrent in torrents %}
                        <tr>
                            <td><input type="checkbox" name="torrent_ids" value="{{ torrent.id }}"></td>
                            <td>{{ torrent.name }}</td>
                            <td>{{ torrent.size }}</td>
                            <td>{{ torrent.pieces }}</td>
                            <td>{{ torrent.piece_size }}</td>
                            <td>{{ torrent.seed }}</td>
                            <td>{{ torrent.leech }}</td>
                            <td>{{ torrent.dl_number }}</td>
                            <td>{{ torrent.dl_completed }}</td>
                            <td>{{ torrent.added_at }}</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
            <button type="submit" class="btn btn-danger">Delete Selected</button>
        </form>

        <h3>Upload a Torrent</h3>
        <form method="post" action="{% url 'file_upload' %}" enctype="multipart/form-data">
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit" class="btn btn-primary">Upload</button>
        </form>
</div>

{% endblock %}
